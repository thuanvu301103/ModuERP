{% load static %}

<div class="" style="overflow-y: auto; max-height: 85vh;">
<table class="table table-dark table-hover table-striped align-middle">
  <thead style="position: sticky; top: 0; z-index: 10;">
    <tr>
      <th class="text-center" style="width: 5%;">
        <input type="checkbox" id="select-all" class="form-check-input bg-dark border-indigo-5">
      </th>
      <th class="text-start px-3" style="width: 25%;">Name</th>
      <th class="text-start px-3" style="width: 10%;">Code</th>
      <th class="text-start px-3" style="width: 15%;">Type</th>
      <th class="text-start px-3" style="width: 15%;">Category</th>
      <th class="text-end px-3" style="width: 15%;">List Price</th>
      <th class="text-end px-3" style="width: 15%;">Standard Price</th>
    </tr>
  </thead>
  <tbody class="table-group-divider">
    {% for p in products %}
    <tr>
      <td class="text-center">
        <input type="checkbox" class="select-item form-check-input bg-dark border-indigo-5" value="{{ p.id }}">
      </td>
      <td class="text-start px-3 text-light">{{ p.name }}</td>
      <td class="text-start px-3 text-light">{{ p.default_code|default:"" }}</td>
      <td class="text-start px-3 text-light">{{ p.product_type }}</td>
      <td class="text-start px-3 text-light">{{ p.category }}</td>
      <td class="text-end px-3 text-light">{{ p.list_price }}</td>
      <td class="text-end px-3 text-light">{{ p.standard_price }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>


<script>
  function updateSelectedCount() {
    let selected = document.querySelectorAll(".select-item:checked").length;
    document.getElementById("selected-count").innerText = selected;
  }

  // Click select-all checkbox → check/uncheck all child checkboxes
  document.getElementById("select-all").addEventListener("change", function() {
    let checked = this.checked;
    document.querySelectorAll(".select-item").forEach(cb => cb.checked = checked);
    updateSelectedCount(); // cập nhật số lượng
  });

  // Click any child checkbox → update select-all checkbox state + count
  document.querySelectorAll(".select-item").forEach(cb => {
    cb.addEventListener("change", function() {
      let all = document.querySelectorAll(".select-item").length;
      let selected = document.querySelectorAll(".select-item:checked").length;
      document.getElementById("select-all").checked = (all === selected);
      updateSelectedCount(); // cập nhật số lượng
    });
  });
</script>
